[raypeat.rodeo](https://raypeat.rodeo) is the open-source effort to transcribe
the public works of Ray Peat.

[![Deploy to GitHub Pages](https://github.com/marcuswhybrow/ray-peat-rodeo/actions/workflows/gh-pages.yml/badge.svg)](https://github.com/marcuswhybrow/ray-peat-rodeo/actions/workflows/gh-pages.yml)
[![Built with Nix](https://builtwithnix.org/badge.svg)](https://builtwithnix.org)

![banner](https://raw.githubusercontent.com/marcuswhybrow/ray-peat-rodeo/back-to-go/internal/assets/docs/ray-peat-rodeo-banner.png)

# Getting Started

Get [Nix Package Manager](https://nixos.org/download.html#download-nix), then 
clone this repository and start the auto-reloading dev server:

```bash
git clone git@github.com:marcuswhybrow/ray-peat-rodeo.git
cd ray-peat-rodeo
nix develop -c modd
```

- `./assets` contains a markdown file for each article or transcription.
- `./assets/todo` contains a markdown file for assets without transcriptions.
- `./github/workflows/gh-pages` auto deploys this repo to https://raypeat.rodeo
- `./cmd/ray-peat-rodeo` is the code that builds the website from the markdown 
assets.
- `./cmd/whisper-json2md` is a custom tool to massage AI transcripts to 
markdown (see [here](#ai-transcription)).
- `./internal` contains this projects unique features, especially 
`./internal/markdown` and `./internal/cache/` which provide custom markdown 
plugins and automatic caching of remote data (e.g. GitHub issue titles).

Those are the main things, and editing any of them trigger the dev server to 
auto reload, and your browser should hot-load the changes and auto refresh, 
making a near instant dev cycle.

- `./flake.nix` & `./flake.lock` tell the `nix` command how to do everything 
for us, for example the dev server (lauched by `nix develop -c modd`), tells
nix to examine `./flake.nix` enter the custom shell environment defined 
there, and run the command `modd` which is our dev server of choice.
- `./gomod2nix.toml` in conjunction with `./flake.nix` helps the `nix` command 
build this project. It's autogenerated by running `nix develop -c gomod2nix`.
- `./modd.conf` tells `modd` how to behave, such as running Tailwind CCS 
process automatically.
- `./tailwind.config.js` tells tailwind how to do it's thing.

And finally, you may want to use `direnv` & `nix-direnv` to automatically load
all project dependencies and tools into your shell environment whilst you are 
inside the project directory (auto unloads when you leave it). In the root of 
the project directory:

```bash
cat "use flake" > .envrc
direnv allow
```

# AI Transcription

This project aims to create transcripts of Ray Peat's interviews in order to 
then augment them with metadata and annotations, this is slow.

A similar project exists called [The Ray Peat Archive](https://github.com/0x2447196/raypeatarchive) 
which is much faster. It uses AI to transcribe the audio, and it's fast.
RPA has the far superior quantity of transcription.

This project will catch up by copying their approach. `./assets/todo` contains
every transcript-less interview for which a URL is known. What follows is an 
example of my AI workflow to grab the audio from that URL, use AI to transcribe 
it, and wrangle it into custom markdown.

```bash
# Inside project directory, launch shell with necessary tools in environment
nix develop 

# Pick a markdown file from ./assets/todo and copy the source URL.
# This command downloads that URL as an audio file called "source-audio"
yt-dlp -x "https://website.com/some-video-or-audio-file-url" -o source-audio

# Next we get OpenAI's Whisper to transcribe the audio file into a JSON file.
# This takes a while, and creates "source-audio.json"
whisper --language English --output_format json source-audio

# Finally, transform the resulting JSON into markdown.
# This command outputs markdown to stdout, so here we redirect stdout to append 
# to whichever markdown file we took the original audio URL from
whisper-json2md source-audio.json >> ./assets/todo/2022-08-19-example.md
```
